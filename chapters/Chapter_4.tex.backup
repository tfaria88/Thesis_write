%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%%                                              %%%%%%
%%%%  Author: Name des Autors                     %%%%%%
%%%%                                              %%%%%%
%%%%  Beschreibung:                               %%%%%%
%%%%                                              %%%%%%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%


\chapter{Results}
\label{chap:chapter_4}



\section{Configuration files}
\label{sec:section 1}

The implementation of additional classes and functions in LAMMPS was described in the previous chapter, transforming the software ready to perform simulations with swimmers using
transport-velocity SPH formulation. Many input configuration files were created to setup the simulations. A flowchart in Figure~\ref{fig:Bild4.1} describes the input configuration
files and their relations.

\begin{figure}[H]
\centering
  \begin{footnotesize}
  \includesvg{images/config}
  \caption[Configuration files]{Configuration files}
  \label{fig:Bild4.1}
  \end{footnotesize}
\end{figure} 

The first input configuration file is \textit{in.vars}, which is responsible for defining the main variables necessary for the simulation. The variables here defined are used in most of other configuration files 
The most essential variables defined in this file are:

\begin{itemize}
  \item Simulation dimension (2D/3D)
  \item Simulation box lengths
  \item Smoothing length $h$
  \item Sound speed
  \item SPH density
  \item Viscosity parameters
  \item Atom types
  \item Relaxation parameters
  \item Dumping parameters
\end{itemize}


Next, the generation of an initial particle grid is set in \textit{in.geninit}. Here the atom styles for the particles are defined, and as it is more then one type, a hybrid type
combining \textit{meso} (for the SPH Particles) and \textit{bond} (for the particles belonging to the bonds) is set. To allocate the particles in the box, a lattice distribution is used.
This file will generate a data file containing all particle information related to its position in the domain, called \textit{data.grid}, and this will be the initial file to be 
modified by \textit{addswimmer}, described in Chapter 3.2 . \par
The function \textit{addswimmer} will output files with the swimmer data. The files \textit{in.swimmer.parameters}, \textit{in.swimmer.topology}, \textit{in.swimmer.change.type}
contain information about the swimmer structure, its position in the fluid domain, all data related to bonds (including bond types and the  output of those data into a LAMMPS
template to be used by the following files). The input file \textit{in.swimmer} works similar to the main variables file, but here it gives all necessary parameters and bond
coefficients to determine the swimmer motion behavior, as:

\begin{itemize}
  \item Potential energy $U_{min}$ (used to calculate the bond stiffness $K$)
  \item Wave amplitude $A$ 
  \item Wave velocity $vel_sw$
  \item Wase phase $\phi$
  \item Angular frequency $\omega$ ,etc
\end{itemize}

With all data concerning to the swimmer structures and coefficients, the parameters for running simulation are selected in \textit{in.run}. Here, the detailed methodology used
for the computation is set, SPH formulation (transport-velocity), time integration, relaxation and dumping style. All data are compiled together in a folder and divided in 
separate files containing specific data for each timestep. The following files are generated:

\begin{itemize}
  \item \textit{dump files}: data in LAMMPS template containing flow field parameters or images for post-processing; 
  \item \textit{pswimmer.dat}: file containing history data for plotting physical time, particle density and power;  
  \item \textit{pmoments.dat}: file containing history data for plotting center of mass, velocities, forces, torques and physical time; 
  \item \textit{swimmer.dat}: file with all swimmer structure data.
\end{itemize}


\section{Fluid domain}
\label{sec:section 2}

The simulations were based on a body, composed by head and tail, swimming in a fluid. All boundaries were treated as periodic boundaries.The particles inside the domain were distributed according to a square lattice distribution. The selected lattice is
called in LAMMPS as \textit{sq2}, where 2 basis atoms (one at the corner and one at the center of the square) create an upright square lattice. This particle distribution 
generates an equidistant symmetric grid of particles. Selecting square lattice was crucial to create the swimmer structure as the bonds are based on the particle position in a line, 
making it easy to define relations between all particles along the swimmer.\par
In the same time that the particles organization generated by the square lattice was extremely beneficial to create the swimmer, it brings together an disadvantage of not representing
a realistic fluid distribution in real ambient. Swimmers do not find in nature an ambient where all fluid particles are symmetrically organized, those particles are randomly 
positioned due to perturbations suffered by the environment. To reach a more realistic scenario, the liquid was heated up with the application of a Langevin thermostat \cite{schneider_molecular-dynamics_1978}.
In Langevin dynamics, the temperature is maintained by modifying the equation of motion:

\begin{equation}
\dot{r}_{i} = \frac{p_{i}}{m_{i}} \quad \quad \text{and} \quad \quad \dot{p}_{i}= F_{i} - \gamma_{i} p_{i} + f_{i}
\end{equation}

where $F_{i}$ is the force acting on atom $i$ due to interaction potential, $\gamma_{i}$ is a friction coefficient and $f_{i}$ is a random force with dispersion $\sigma_{i}$ via:


\begin{equation}
\sigma_{i}^2 = 2 m_{i} \gamma_{i} k_{B} T / \Delta t
\end{equation}

with $\Delta t$ being the time step.\par

This Langevin thermostat is applied during a first relaxation period through the LAMMPS function \textit{fix langevin} and in a second relaxation period it is canceled using
\textit{unfix langevin}, to cancel all linear and angular momentum of the particles. In Figure~\ref{fig:Bild4.2}, it is represented how the particles were organized before and after the
application of the Langevin thermostat.



\begin{figure}[H]
\centering
  \begin{footnotesize}
  \includesvg{images/langevin}
  \caption[In upper image the particles are allocated in the domain via square lattice distribution and in the lower image the particles rearranged their position after heating up with the  Langevin thermostat]{In upper image the particles are allocated in the domain via square lattice distribution and in the lower image the particles rearranged their position after heating up with the  Langevin thermostat}
  \label{fig:Bild4.2}
  \end{footnotesize}
\end{figure} 


The influence of the simulation domain was also analyzed to ensure that the simulation box is large enough and it does not influence on the final results. The simulation box 
lengths are $L_{x}= 8m$ in x-direction and $L_{y}=2m$ in y-direction . Those lengths were doubled and simulated for $L_{x}= 8m$ and $L_{y}=2m$. The swimmer velocity in x-direction
for two equal swimmers were compared and plotted in Figure~\ref{fig:Bild4.3}, one on the small box and the other on the larger one. The results show that the small simulation box is 
satisfactory as the simulation time is much lower, where for the small box the time necessary for 1000 timesteps is $4'42''$ and for the larger box the same number of timesteps
lasted $16'31''$.


\begin{figure}[H]
\centering
  \begin{footnotesize}
  \includesvg{images/box_graph}
  \caption[Swimmer velocity in x-direction for a small and a large box]{Swimmer velocity in x-direction for a small and a large box }
  \label{fig:Bild4.3}
  \end{footnotesize}
\end{figure} 


\section{Swimmer with constant amplitude}
\label{sec:section 3}

The simulation domain is two-dimensional rectangular box with lengths $L_{x}= 8m$ in x-direction and $L_{y}=2m$ in y-direction, with periodic boundary conditions. All variables
and coefficients are set in SI units. The smoothing length $h=0.1m$ and the distance between particles for the lattice distribution $dx=h/3$. The SPH variables are shown in
table bellow:
\par


\begin{table}[h]
\begin{tabular}{l|l|l|l|l}
Variable & sph\_rho0              & sph\_rho                & sph\_eta\_real            & sph\_eta\_relaxation     \\ \hline
         & \multicolumn{1}{c|}{1} & \multicolumn{1}{c|}{1} & \multicolumn{1}{c|}{5e-4} & \multicolumn{1}{c}{5e-3}
 \caption{Initial SPH coefficients}
 \label{table4.1}
\end{tabular}
\end{table}

where sph\_rho0 and sph\_rho are the reference density in equation of state and the SPH density respectively and sph\_eta\_real and sph\_eta\_relaxation are the fluid viscosity
for the simulation and for the relaxation period respectively. Here, the backward pressure force is $p_{b} = (sph\_c)^2 sph\_rho$. The Reynolds number is $Re=10$ \par

The swimmer flesh head has different characteristics from the other particles in the swimmer, with a lower mass and density. With this parameters the swimmer head will deform as 
described in Chapter 2.2. To describe the swimmer motion, the bond coefficients were set to input a constant amplitude and a constant stiffness along the tail, no phase shift and a wave velocity of $v = 0.05 m/s$.\par
Figure~\ref{fig:Bild4.4} display the velocity vector field around the swimmer, showing the vortices created along the swimmer and on the tail tip.

\begin{figure}[H]
\centering
  \begin{footnotesize}
  \includesvg{images/c_a_c_k_part}
  \caption[Velocity vector field]{Velocity vector field nearby the swimmer}
  \label{fig:Bild4.4}
  \end{footnotesize}
\end{figure} 



\begin{figure}[H]
\centering
  \begin{footnotesize}
  \includesvg{images/ca_ck_id}
  \caption[Particles distribution in the domain colored by particles ID's]{Particles distribution in the domain colored by particles ID's}
   \label{fig:Bild4.5}
  \end{footnotesize}
\end{figure} 

In Figure~\ref{fig:Bild4.5}, the particles are colored by ID's values, displaying how the fluid particles are distributed in the domain after the disturbances caused by the swimmer.
The graphs below plot the swimmer velocity in x-direction(Figure~\ref{fig:Bild4.6}), the force-x in the center of mass (Figure~\ref{fig:Bild4.7}).


\begin{figure}[H]
\centering
  \begin{footnotesize}
  \includesvg{images/vel_c_a_c_k}
  \caption[Swimmer velocity in x-direction]{Swimmer velocity in x-direction}
   \label{fig:Bild4.6}
  \end{footnotesize}
\end{figure} 


\begin{figure}[H]
\centering
  \begin{footnotesize}
  \includesvg{images/fcm_ca_ck}
  \caption[Force in x-direction in th swimmer center of mass]{Force in x-direction in th swimmer center of mass}
   \label{fig:Bild4.7}
  \end{footnotesize}
\end{figure} 


An interesting observation is the path of the swimmer center of mass, which it does not swim straight in the x-axis. The swimmer tends to curve upwards and it accentuates in time.
This phenomena was also observed by Tytell and Hsu \cite{tytell_interactions_2010}. The swimmer path can be seen in Figure~\ref{fig:Bild4.8}, plotting the x and y-position of the
swimmer center of mass in time.


\begin{figure}[H]
\centering
  \begin{footnotesize}
  \includesvg{images/xcm_ca_ck}
  \caption[Swimmer center of mass path]{Swimmer center of mass path}
   \label{fig:Bild4.8}
  \end{footnotesize}
\end{figure} 


Further simulations were performed to analyze the influence of the wave amplitude value in the swimmer performance. Two other amplitude values were selected, two times the initial value
($2A$) and  half value of the initial amplitude ($A$). The following graphs compare the results for velocity in x-direction (Figure~\ref{fig:Bild4.9}),, force in x-direction
(Figure~\ref{fig:Bild4.10}) and the swimmer path in time(Figure~\ref{fig:Bild4.11}). \par
As higher the wave amplitude is, the higher the swimmer velocity will be. Similarly, the forces in the center of mass are also increasing
as the wave amplitude is increased. Examining the plots for the swimmer path, it is intriguing the swimming direction for those amplitudes. With an amplitude of $2A$ the swimmer
tends to turn downwards, differently to the amplitude $A$ which also tends to turn but in the opposite direction. The turning pattern of amplitude $2A$ and $A/2$ are similar, 
creating no relations between the amplitude value increase and the turning path.


\begin{figure}[H]
\centering
  \begin{footnotesize}
  \includesvg{images/c_amp_comp}
  \caption[Swimmer velocity in x-direction for amplitudes $A$, $2A$ and $A/2$ ]{Swimmer velocity in x-direction for amplitudes $A$, $2A$ and $A/2$ }
   \label{fig:Bild4.9}
  \end{footnotesize}
\end{figure} 

\begin{figure}[H]
\centering
  \begin{footnotesize}
  \includesvg{images/c_amp_comp_fx}
  \caption[Force in x-direction in th swimmer center of mass for amplitudes $A$, $2A$ and $A/2$]{Force in x-direction in th swimmer center of mass for amplitudes $A$, $2A$ and $A/2$}
   \label{fig:Bild4.10}
  \end{footnotesize}
\end{figure} 

\begin{figure}[H]
\centering
  \begin{footnotesize}
  \includesvg{images/c_amp_comp_xcm}
  \caption[Swimmer center of mass path for amplitudes $A$, $2A$ and $A/2$]{Swimmer center of mass path for amplitudes $A$, $2A$ and $A/2$}
   \label{fig:Bild4.11}
  \end{footnotesize}
\end{figure}


\section{Swimmer with increasing amplitude along tail}
\label{sec:section 4}

The SPH parameters used in the previous simulation remain the same. The difference is now the linear relation that defines the wave amplitude values, increasing along the swimmer
from head to tail. Amplitude now is divided in two parameters: the initial standard wave amplitude value $A_{alpha}$ and the slope parameter for the linear relation $A_{beta}$.
With these relations, the amplitude value near the head is $A$ and the amplitude in the end of the tail active line is equal to $2A$. Figure~\ref{fig:Bild4.12} displays the velocity
vector field around the swimmer, showing the vortices created along the swimmer and on the tail tip. For this swimmer, the velocity vectors have higher values when compared to the
constant amplitude simulation.
 


\begin{figure}[H]
\centering
  \begin{footnotesize}
  \includesvg{images/e_a_vec}
  \caption[Velocity vector field nearby the swimmer]{Velocity vector field nearby the swimmer}
   \label{fig:Bild4.12}
  \end{footnotesize}
\end{figure}

\begin{figure}[H]
\centering
  \begin{footnotesize}
  \includesvg{images/e_a_comp}
  \caption[Comparison swimmer motion with constant $A$ along the swimmer and linearly increasing $A$ along the swimmer]{Compare swimmer motion with constant $A$ along the swimmer and linearly increasing $A$ along the swimmer}
   \label{fig:Bild4.13}
  \end{footnotesize}
\end{figure}


The graphs below plot the swimmer velocity in x-direction(Figure~\ref{fig:Bild4.14}), the force-x in the center of mass (Figure~\ref{fig:Bild4.15}) and the path of the swimmer center
of mass(Figure~\ref{fig:Bild4.16}), with all graphs comparing with previous results:



\begin{figure}[H]
\centering
  \begin{footnotesize}
  \includesvg{images/e_a_vx}
  \caption[Swimmer velocity in x-direction for amplitudes $A$, $2A$ and $A+$ ]{Swimmer velocity in x-direction for amplitudes $A$, $2A$ and $A+$ }
   \label{fig:Bild4.14}
  \end{footnotesize}
\end{figure}


\begin{figure}[H]
\centering
  \begin{footnotesize}
  \includesvg{images/e_a_fx}
  \caption[Force in x-direction in th swimmer center of mass for amplitudes $A$, $2A$ and $A+$]{Force in x-direction in th swimmer center of mass for amplitudes $A$, $2A$ and $A+$}
   \label{fig:Bild4.15}
  \end{footnotesize}
\end{figure}


\begin{figure}[H]
\centering
  \begin{footnotesize}
  \includesvg{images/e_a_xcm}
  \caption[Swimmer center of mass path for $A$, $2A$ and $A+$]{Swimmer center of mass path for $A$, $2A$ and $A+$}
   \label{fig:Bild4.16}
  \end{footnotesize}
\end{figure}


The swimmer path for this model differs from the swimmers with constant wave amplitude beating pattern. The swimmer tends to swim in a straight line, slightly curving in time, while
the swimmer with constant amplitude curves sharply with time. The model presented here brings a better prediction of the swimmer path as it does not curve.


\section{Swimmer depending on stiffness $K$}
\label{sec:section 5}

As described before in Chapter 3.4.2 , tho swimmer body stiffness is an important parameter the influences on its motion. Simulations were performed using the LAMMPS class
\textit{bond$\_$harmonic$\_$swimmer$\_$extended$\_$k} and the bond stiffness defined as constant or ranging its magnitude along the tail. Initially, it was set a reference
amplitude value $K$, and all simulations considered this value  as a reference value to set amplitude. The user do not input directly the bond stiffness value $K$, but the potential
energy $U_{min}$, and its relation is defined in Equation~\ref{k}. The standard value for the potential energy used in the simulation is $U_{min}= 0.0015 kgm^2/s^2$. Figure~\ref{fig:Bild4.17} 
display the velocity vector field around  swimmer , showing the vortices created along the body and on the tail tip. Three different configurations are presented: $(1)$
with constant stiffness value along the tail of value $K/2$, $(2)$ with constant stiffness value along the tail of value $K$ and $(3)$ with constant stiffness value along the tail of value $2K$.
The snapshots were taken at the same time and all with $Re = 10$.


\begin{figure}[H]
\centering
  \begin{footnotesize}
  \includesvg{images/k_vec}
  \caption[]{Velocity vector field nearby the swimmer for body stiffness $K/2$ constant , $K$ constant and $2K$ constant}
   \label{fig:Bild4.17}
  \end{footnotesize}
\end{figure}

As greater the body stiffness along the swimmer tail, the body motion and its beating pattern are strongly influenced. With a low stiffness $K/2$, the velocity vectors around the swimmer
have a low intensity and increasing its value, the vortices created are more intense and it disturbs more the fluid at the rear of the tail.
The graphs below plot the swimmer velocity in x-direction(Figure~\ref{fig:Bild4.18}) and the force-x in the center of mass (Figure~\ref{fig:Bild4.19}) for a different range of $K$ values.


\begin{figure}[H]
\centering
  \begin{footnotesize}
  \includesvg{images/c_k_vx}
  \caption[Swimmer velocity in x-direction for amplitudes $K$, $2K$ and $K/2$ ]{Swimmer velocity in x-direction for amplitudes $K$, $2K$ and $K/2$ }
   \label{fig:Bild4.18}
  \end{footnotesize}
\end{figure}


\begin{figure}[H]
\centering
  \begin{footnotesize}
  \includesvg{images/c_k_fx}
  \caption[Force in x-direction in th swimmer center of mass for amplitudes $K$, $2K$ and $K/2$]{Force in x-direction in th swimmer center of mass for amplitudes $K$, $2K$ and $K/2$}
   \label{fig:Bild4.19}
  \end{footnotesize}
\end{figure}

The swimmer path during swimming is also influenced by the body stiffness. Figure~\ref{fig:Bild4.20} shows the body center of mass path for different values of body stiffness. all 
swimmers tend to curve in some direction: $K$ tends to swim upwards to x-axis in time, $K/2$ tends to swim downwards and $2K$ slightly downwards. From these results, it could be
concluded that as higher the body stiffness, more straight  in line it would swim. To proof this concept, a new simulation with body stiffness $3K$ constant along the body was 
performed and the results are presented in same figure, nullifying the previous concept associating swimmer path straightness with increasing body stiffness.

\begin{figure}[H]
\centering
  \begin{footnotesize}
  \includesvg{images/c_k_xcm}
  \caption[Swimmer center of mass path for body stiffness $K$, $2K$, $K/2$ and $3K$]{Swimmer center of mass path for body stiffness $K$, $2K$, $K/2$ and $3K$}
   \label{fig:Bild4.20}
  \end{footnotesize}
\end{figure}

Now, different configurations were compared to analyze the swimmer motion. Here we compare: $(1)$ a swimmer with constant amplitude $A$ and constant body stiffness $K$ , $(2)$
a swimmer with ranging amplitude $A+$ (where the amplitude near the head is $A$ and in the end of the active tail section is $2A$) and constant body stiffness $K$ and 
$(3)$ a swimmer constant amplitude $A$ with ranging stiffness value along the tail from $2K$ in head to $K$ in the tail tip ( where the ranging stiffness get constant along 
the inactive tail section with value $K$).\par
Below, The graphs plot the swimmer velocity in x-direction(Figure~\ref{fig:Bild4.21}) and the force-x in the center of mass (Figure~\ref{fig:Bild4.22}) for a different range of $K$ values.
The swimmer with ranging amplitude $A+$ reaches the highest mean velocity and body forces while the swimmer with constant amplitude $A$ and stiffness $K$ has the lowest values.
The configuration with ranging body stiffness $K+$ has its values in the middle between the other two swimmers.


\begin{figure}[H]
\centering
  \begin{footnotesize}
  \includesvg{images/vx_compare}
  \caption[Swimmer velocity in x-direction for configurations $const\_A\_const\_A$, $A+$ and $K+$ ]{Swimmer velocity in x-direction for configurations$const\_A\_const\_A$, $A+$ and $K+$ }
   \label{fig:Bild4.21}
  \end{footnotesize}
\end{figure}

\begin{figure}[H]
\centering
  \begin{footnotesize}
  \includesvg{images/fx_compare}
  \caption[Force in x-direction in th swimmer center of mass for configurations $const\_A\_const\_K$ and $K+$]{Force in x-direction in th swimmer center of mass for configurations $const\_A\_const\_K$, $A+$ and $K+$}
   \label{fig:Bild4.22}
  \end{footnotesize}
\end{figure}

When comparing the swimmers path in the domain, the configuration $K+$ is the one that has the straightest path in x-axis, as seen in Figure~\ref{fig:Bild4.23}, turning slightly
upwards in time.


\begin{figure}[H]
\centering
  \begin{footnotesize}
  \includesvg{images/xcm_compare}
  \caption[Swimmer center of mass path for configurations$const\_A\_const\_K$, $A+$ and $K+$]{Swimmer center of mass path for configurations $const\_A\_const\_A$, $A+$ and $K+$}
   \label{fig:Bild4.23}
  \end{footnotesize}
\end{figure}


\section{Reynolds Number}
\label{sec:section 6}

The Reynolds number is a extremely relevant flow parameter, which influences the swimmer motion in our simulations .All previous simulations were performed with a Reynolds number
$Re= 10$. As shown in Equation~\ref{re}, the Reynolds number is a dimensionless number that gives a measure of the ratio of inertial forces to viscous forces and consequently
quantifies the relative importance of these two types of forces for given flow conditions. With these considerations, we set a range of simulations varying the Reynolds number,
and for it, the viscosity was the altered parameter.\par

Simulations for three different Reynolds number were performed: $Re=1$ , $Re=10$ and $Re=100$. To increase the standard Reynolds number $Re=10$, the fluid viscosity was proportionally
decreased and vice versa to decrease the Reynolds number. From Figure~\ref{fig:Bild4.24} to Figure~\ref{fig:Bild4.29}, the comparison results are shown for a same swimmer configuration
in different Reynolds number.  



\begin{itemize}
  \item Constant $A$ and Constant $K$
\end{itemize}


\begin{figure}[H]
\centering
  \begin{footnotesize}
  \includesvg{images/re_vx_const_a}
  \caption[Swimmer velocity in x-direction for configurations $Re=1$, $Re=10$ and $Re=100$ (config. "Constant $A$ and Constant $K$") ]{Swimmer velocity in x-direction for configurations $Re=1$, $Re=10$ and $Re=100$ (config. "Constant $A$ and Constant $K$")}
   \label{fig:Bild4.24}
  \end{footnotesize}
\end{figure}


\begin{figure}[H]
\centering
\begin{subfigure}
\centering
  \begin{footnotesize}
  \includesvg{images/re_xcm_const_a}
  \end{footnotesize}
\end{subfigure}
\begin{subfigure}%
  \centering
  \begin{footnotesize}
  \includesvg{images/re_xcm2_const_a}
  \end{footnotesize}
\end{subfigure}
   \caption[In left graphic, swimmer center of mass path for $Re=1$, $Re=10$ and $Re=100$. In right graphic, a zoomed plot to observe the behavior for $Re=1$ (config. "Constant $A$ and Constant $K$")]{In left graphic, swimmer center of mass path for $Re=1$, $Re=10$ and $Re=100$. In right graphic, a zoomed plot to observe the behavior for $Re=1$ (config. "Constant $A$ and Constant $K$") }
   \label{fig:Bild4.25}
\end{figure}






\begin{itemize}
  \item Ranging $A+$ and Constant $K$
\end{itemize}





\begin{figure}[H]
\centering
  \begin{footnotesize}
  \includesvg{images/re_vx_ext_a}
  \caption[Swimmer velocity in x-direction for configurations $Re=1$, $Re=10$ and $Re=100$ (config. "Ranging $A+$ and Constant $K$")]{Swimmer velocity in x-direction for configurations $Re=1$, $Re=10$ and $Re=100$ (config. "Ranging $A+$ and Constant $K$")}
   \label{fig:Bild4.26}
  \end{footnotesize}
\end{figure}



\begin{figure}[H]
\centering
\begin{subfigure}
\centering
  \begin{footnotesize}
  \includesvg{images/re_xcm_ext_a}
  \end{footnotesize}
\end{subfigure}
\begin{subfigure}%
  \centering
  \begin{footnotesize}
  \includesvg{images/re_xcm2_ext_a}
  \end{footnotesize}
\end{subfigure}
   \caption[In left graphic, swimmer center of mass path for $Re=1$, $Re=10$ and $Re=100$. In right graphic, a zoomed plot to observe the behavior for $Re=1$ (config. "Ranging $A+$ and Constant $K$")]{In left graphic, swimmer center of mass path for $Re=1$, $Re=10$ and $Re=100$. In right graphic, a zoomed plot to observe the behavior for $Re=1$ (config. "Ranging $A+$ and Constant $K$")}
   \label{fig:Bild4.27}
\end{figure}



\begin{itemize}
  \item Constant $A$ and Ranging $K+$
\end{itemize}

\begin{figure}[H]
\centering
  \begin{footnotesize}
  \includesvg{images/re_vx_ext_k}
  \caption[Swimmer velocity in x-direction for configurations $Re=1$, $Re=10$ and $Re=100$ (config. "Constant $A$ and Ranging $K+$")]{Swimmer velocity in x-direction for configurations $Re=1$, $Re=10$ and $Re=100$  (config. "Constant $A$ and Ranging $K+$")}
   \label{fig:Bild4.28}
  \end{footnotesize}
\end{figure}



\begin{figure}[H]
\centering
\begin{subfigure}
\centering
  \begin{footnotesize}
  \includesvg{images/re_xcm_ext_k}
  \end{footnotesize}
\end{subfigure}
\begin{subfigure}%
  \centering
  \begin{footnotesize}
  \includesvg{images/re_xcm2_ext_k}
  \end{footnotesize}
\end{subfigure}
   \caption[In left graphic, swimmer center of mass path for $Re=1$, $Re=10$ and $Re=100$. In right graphic, a zoomed plot to observe the behavior for $Re=1$ (config. "Constant $A$ and Ranging $K+$")]{In left graphic, swimmer center of mass path for $Re=1$, $Re=10$ and $Re=100$. In right graphic, a zoomed plot to observe the behavior for $Re=1$ (config. "Constant $A$ and Ranging $K+$")}
   \label{fig:Bild4.29}
\end{figure}


Decreasing the Reynolds number for $Re=1$, the swimmer decreases significantly its velocity and consequently the displacement in the fluid domain. The swimmer tends to curve upwards
or downwards, depending on the configuration, and it swims under a constant velocity.\par
When the Reynolds number is increased to $Re=100$, increases substantially its average velocity. For configuration "Constant $A$ and Constant $K$", the velocity in x-direction 
does not have the same steady behavior as in $Re=1$, decreasing its average velocity after $T_{phys}= 2500$.  For configuration "Ranging $A+$ and Constant $K$", the swimmer 
has an unsteady behavior for $Re=100$, increasing and decreasing lawlessly. This can also be observed in the swimmer path for the same Reynolds number, swimming in random directions alternating
in upwards and downwards direction. For configuration "Constant $A$ and Ranging $K+$", the velocity also has an unsteady behavior but not so accentuated as the previous one, being
more similar with the swimmer with constant amplitude and stiffness. Observing the swimmer center of mass path plot, the strong unsteady behavior observed in previous configuration
is not present, but the swimmer tends to curve in upwards direction, achieving in some moments close to a straight path in y-axis direction.\par

The velocity field for a swimmer in two different Reynolds number flows. In Figures~\ref{fig:Bild4.30}, the swimmer with constant
amplitude and body stiffness swims with $Re=10$. A single strong vortex is dropped each time the tail reverses direction and other multiple weak vortices are also produced, but
those vortices are rapidly dissipated due to its Reynolds number. For a swimmer with same configuration, but in a flow with $Re=100$, the vortices generated by the tail do not 
dissipates easily, changing completely the flow field. The strong vortices dropped by the tail and not dissipated can be seen in the Figure~\ref{fig:Bild4.31}.






\begin{figure}[H]
\centering
  \begin{footnotesize}
  \includesvg{images/re_10_vx}
  \caption[Velocity flow field for a swimmer with constant amplitude and stiffness along the body with $Re=10$]{Velocity flow field for a swimmer with constant amplitude and stiffness along the body with $Re=10$}
   \label{fig:Bild4.30}
  \end{footnotesize}
\end{figure}


\begin{figure}[H]
\centering
  \begin{footnotesize}
  \includesvg{images/re_100_vx}
  \caption[Velocity flow field for a swimmer with constant amplitude and stiffness along the body with $Re=100$]{Velocity flow field for a swimmer with constant amplitude and stiffness along the body with $Re=100$}
   \label{fig:Bild4.31}
  \end{footnotesize}
\end{figure}


\section{Swimmer efficiency}
\label{sec:section 7}


To evaluate the swimming efficiency of the swimmer configurations simulated, it was evaluated the power spent per displacement. The swimmer power measures the rate of change of
energy, and it was calculated as:


\begin{equation} 
  P = 	\frac{\partial W}{\partial t} = F v ;
\end{equation}

where $W$ is the work produced. The swimmer displacement in time was fitted by a linear polynomial, generating a displacement coefficient used to calculate the efficiency.\par

The power in time can be seen in Figure~\ref{fig:Bild4.32} for a swimmer constant amplitude and stiffness along the body at $Re=10$. The oscillating carrier shown in the curve was 
approximated by an cumulative integral of power via trapezoidal method with unit spacing. The cumulative power for different swimmers configurations was plotted in the figures bellow.
Here, also the cumulative power in time was fitted by a linear polynomial, generating the power coefficient used to calculate efficiency.




\begin{figure}[H]
\centering
  \begin{footnotesize}
  \includesvg{images/power_noise}
  \caption[Swimmer power in time for a swimmer with constant stiffness and amplitudes]{Swimmer power in time for a swimmer with constant stiffness and amplitudes}
   \label{fig:Bild4.32}
  \end{footnotesize}
\end{figure}


\begin{figure}[H]
\centering
\begin{subfigure}
\centering
  \begin{footnotesize}
  \includesvg{images/power_a}
  \end{footnotesize}
\end{subfigure}
\begin{subfigure}%
\centering
  \begin{footnotesize}
  \includesvg{images/power_k}
     \end{footnotesize}
\end{subfigure}
\label{fig:Bild4.33}
  \caption[In the left side, plot of cumulative power in time for swimmers with different amplitude parameters. In the right side, plot of cumulative power in the time for swimmers with different body stiffness parameters]{In the left side, plot of cumulative power in time for swimmers with different amplitude parameters. In the right side, plot of cumulative power in the time for swimmers with different body stiffness parameters}
\end{figure}



\begin{figure}[H]
\centering
  \begin{footnotesize}
  \includesvg{images/power_compare}
  \caption[Plot comparing the cumulative power in time for different swimmers configurations]{Plot comparing the cumulative power in time for different swimmers configurations}
   \label{fig:Bild4.xxx}
  \end{footnotesize}
\end{figure}

With the calculated parameters, it is possible to calculate the swimmers efficiency for each simulated configuration. The efficiency is calculated the cumulative power used to move
the swimmer a certain distance, relating the displacement coefficient and the power coefficient:

\begin{equation} 
  C_{eff} = \frac{S_{coeff}}{P_{coeff}}
\end{equation}

The table below present the result comparing the efficiency for all the simulated swimmers with diverse configurations. The swimmer speed is not considered to calculate its efficiency.


\begin{table}[h]
\begin{tabular}{|c|c|c|c|}
\hline
                 & Efficiency & Displacement Coeff & Power Coeff \\ \hline
Constant A and K & 9908       & 2.13e-03           & 2.15e-06    \\ \hline
Constant 2A      & 7256       & 6.62e-03           & 9.13e-06    \\ \hline
Constant A/2     & 9807       & 4.03e-04           & 4.11e-07    \\ \hline
Constant K/2     & 8919       & 8.92e-04           & 1e-06       \\ \hline
Constant 2K      & 9099       & 4.86e-03           & 5.34e-06    \\ \hline
A +              & 8427       & 4.92e-03           & 5.84e-06    \\ \hline
K +              & 9272       & 3.39e-3            & 3.66e-06    \\ \hline
\end{tabular}
\caption{Swimmers efficiency}
\end{table}